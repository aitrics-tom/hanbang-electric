# NeMo Guardrails Configuration for JeonsilAI
# 전기기사 AI 풀이 서비스 Guardrails 설정

models:
  - type: main
    engine: openai
    model: gpt-4-turbo-preview

instructions:
  - type: general
    content: |
      당신은 전기기사 자격증 시험 문제 풀이를 전문으로 하는 AI 튜터입니다.

      핵심 역할:
      - 전기기사 실기 및 필기 문제 풀이
      - KEC(한국전기설비규정) 기반 답변
      - 전기공학 이론 및 공식 설명
      - 단계별 문제 해결 가이드

      준수 사항:
      - 항상 KEC 규정을 인용하여 답변
      - 공식 사용 시 변수 설명 포함
      - 계산 과정을 단계별로 명확히 설명
      - 안전 관련 내용은 특별히 강조

      금지 사항:
      - 전기 관련이 아닌 질문에 답변 금지
      - 시험 부정행위 조장 금지
      - 불법적인 전기공사 조언 금지

# 입력 검증 Rails
input_rails:
  - topical_check
  - blocked_content_check
  - input_length_check

# 출력 검증 Rails
output_rails:
  - kec_validation
  - formula_validation
  - calculation_validation
  - unit_validation
  - safety_check

# 사용자 메시지 템플릿
prompts:
  - task: self_check_input
    content: |
      사용자의 질문이 전기기사 관련 주제인지 확인합니다.

      허용된 주제: 전기설비, 전기공사, 전력계통, 시퀀스, PLC, 조명, 역률,
      변압기, 접지, KEC, 전기기사, 수변전, 배선, 단락, 과전류, 누전

      질문: {{ user_input }}

      이 질문이 전기기사 관련인지 YES 또는 NO로 답하세요.

  - task: self_check_output
    content: |
      AI 응답의 품질을 검증합니다.

      검증 항목:
      1. KEC 규정 인용이 적절한가?
      2. 공식이 정확하게 사용되었는가?
      3. 계산 과정이 명확한가?
      4. 단위가 올바르게 표기되었는가?

      응답: {{ bot_response }}

      모든 검증을 통과하면 PASS, 문제가 있으면 FAIL과 이유를 답하세요.

# 허용된 전기기사 관련 주제
allowed_topics:
  - 전기설비
  - 전기공사
  - 전력계통
  - 시퀀스
  - PLC
  - 조명
  - 역률
  - 변압기
  - 접지
  - KEC
  - 전기기사
  - 수변전
  - 배선
  - 단락
  - 과전류
  - 누전
  - 전압강하
  - 임피던스
  - 차단기
  - 계전기
  - 축전지
  - 태양광
  - 전동기
  - 발전기

# 차단된 패턴
blocked_patterns:
  - "욕설"
  - "비속어"
  - "공격적"
  - "개인정보"
  - "주민등록"
  - "전화번호"
  - "해킹"
  - "크래킹"
  - "불법"
  - "부정행위"
  - "답지 유출"

# SI 단위 목록
si_units:
  - V
  - A
  - W
  - "\u03A9"  # Omega (Ω)
  - F
  - H
  - lx
  - lm
  - cd
  - m
  - "mm\u00B2"  # mm²
  - kVA
  - kVar
  - kW
  - kWh
  - mA
  - "\u00B0"  # degree (°)

# 검증 임계값
validation_thresholds:
  min_confidence: 0.7
  calculation_tolerance_percent: 1
  min_input_length: 3
  max_input_length: 2000
  max_image_size_mb: 10

# 필수 응답 필드
required_output_fields:
  - answer
  - steps
  - formulas

# Colang 규칙 파일 경로
colang_files:
  - rails/input.co
  - rails/output.co
